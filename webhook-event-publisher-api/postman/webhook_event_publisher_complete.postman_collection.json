{
  "info": {
    "name": "Webhook Event Publisher API - Complete",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Complete Postman collection for Webhook Event Publisher API endpoints"
  },
  "item": [
    {
      "name": "Event Publishing",
      "item": [
        {
          "name": "POST /webhook/event/publisherCE - CloudEvents",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Event-Id",
                "value": "f701560e-a31b-4748-927f-2655caf785f9",
                "description": "Optional: Override event ID from payload",
                "disabled": true
              },
              {
                "key": "Idempotency-Key",
                "value": "idemp-key-{{$randomUUID}}",
                "description": "Optional: Idempotency key for duplicate detection",
                "disabled": true
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"f701560e-a31b-4748-927f-2655caf785f9\",\n  \"type\": \"com.bee.us.card.activation\",\n  \"source\": \"payments\",\n  \"subject\": \"transactionCreated\",\n  \"specVersion\": \"1.0\",\n  \"time\": \"2025-12-06T14:00:00Z\",\n  \"data\": {\n    \"transactionId\": \"txn-999\",\n    \"customerId\": \"cust-001\",\n    \"amount\": 150.75,\n    \"currency\": \"USD\",\n    \"status\": \"SUCCESS\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/webhook/event/publisherCE",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "event",
                "publisherCE"
              ]
            },
            "description": "Publishes a CloudEvents format event.\n\nField Mapping:\n- source → PRODUCER_DOMAIN\n- subject → EVENT_NAME\n- specVersion → VERSION\n\nValidates data against JSON Schema and publishes to Kafka topic: wh.ingress.{domain}.{eventName}"
          },
          "response": []
        },
        {
          "name": "POST /webhook/event/publisher - Generic",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Event-Id",
                "value": "{{$randomUUID}}",
                "description": "Optional: Event ID (generated if not provided)",
                "disabled": true
              },
              {
                "key": "Idempotency-Key",
                "value": "idemp-key-{{$randomUUID}}",
                "description": "Optional: Idempotency key for duplicate detection",
                "disabled": true
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"domain\": \"payments\",\n  \"eventName\": \"transactionCreated\",\n  \"version\": \"1.0\",\n  \"data\": {\n    \"transactionId\": \"txn-999\",\n    \"customerId\": \"cust-001\",\n    \"amount\": 150.75,\n    \"currency\": \"USD\",\n    \"status\": \"SUCCESS\",\n    \"metadata\": {\n      \"source\": \"mobile-app\"\n    }\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/webhook/event/publisher",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "event",
                "publisher"
              ]
            },
            "description": "Publishes a generic format event with domain, eventName, and version in the body.\n\nValidates data against JSON Schema or Avro Schema and publishes to Kafka topic: wh.ingress.{domain}.{eventName}"
          },
          "response": []
        },
        {
          "name": "POST /webhook/schema/schema_id/{schemaId}",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Event-Id",
                "value": "{{$randomUUID}}",
                "description": "Optional: Event ID (generated if not provided)",
                "disabled": true
              },
              {
                "key": "Idempotency-Key",
                "value": "idemp-key-{{$randomUUID}}",
                "description": "Optional: Idempotency key for duplicate detection",
                "disabled": true
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"transactionId\": \"txn-999\",\n  \"customerId\": \"cust-001\",\n  \"amount\": 150.75,\n  \"currency\": \"USD\",\n  \"status\": \"SUCCESS\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/webhook/schema/schema_id/SCHEMA_PAYMENTS_TRANSACTIONCREATED_1_0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "schema",
                "schema_id",
                "SCHEMA_PAYMENTS_TRANSACTIONCREATED_1_0"
              ]
            },
            "description": "Publishes an event using schema ID. Validates schema and topic status must be ACTIVE."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Schema Management",
      "item": [
        {
          "name": "GET /webhook/schema/all",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/webhook/schema/all",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "schema",
                "all"
              ]
            },
            "description": "Retrieves all active schema definitions from the event_schema table."
          },
          "response": []
        },
        {
          "name": "GET /webhook/schema/schema_id/{schemaId}",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/webhook/schema/schema_id/SCHEMA_PAYMENTS_TRANSACTIONCREATED_1_0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "schema",
                "schema_id",
                "SCHEMA_PAYMENTS_TRANSACTIONCREATED_1_0"
              ]
            },
            "description": "Retrieves a complete schema definition by EVENT_SCHEMA_ID."
          },
          "response": []
        },
        {
          "name": "GET /webhook/schema/{domain}/{event}/{version}",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/webhook/schema/payments/transactionCreated/1.0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "schema",
                "payments",
                "transactionCreated",
                "1.0"
              ]
            },
            "description": "Retrieves schema metadata for a specific event version."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Cache Management",
      "item": [
        {
          "name": "POST /webhook/schema/evict/all",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/webhook/schema/evict/all",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "webhook",
                "schema",
                "evict",
                "all"
              ]
            },
            "description": "Clears all cached schema definitions and reloads them from DynamoDB."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    }
  ]
}

